# my-ai-pet

my-ai-petì€ ë°ìŠ¤í¬í†± í™”ë©´ ìœ„ë¥¼ ììœ ë¡­ê²Œ ë¶€ìœ í•˜ëŠ” íˆ¬ëª…í•œ AI ìºë¦­í„° ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. Electronê³¼ Reactë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì œì‘ë˜ì—ˆìœ¼ë©°, Ollamaë¥¼ í†µí•œ ë¡œì»¬ AI ì±„íŒ…ê³¼ íˆ¬ëª…ë„ ê¸°ë°˜ì˜ ë§ˆìš°ìŠ¤ í´ë¦­ í†µê³¼ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

- **íˆ¬ëª…ë„ ê¸°ë°˜ í´ë¦­ í†µê³¼**: ìºë¦­í„°ì˜ íˆ¬ëª…í•œ ì˜ì—­ì€ ë§ˆìš°ìŠ¤ í´ë¦­ì´ í†µê³¼ë˜ì–´ ë’¤ìª½ì˜ ì°½ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **3ê°€ì§€ ìƒí˜¸ì‘ìš© ëª¨ë“œ**: ìƒí™©ì— ë”°ë¼ ìºë¦­í„°ì˜ ë°˜ì‘ ë°©ì‹ì„ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë³„ë„ ì±„íŒ… ì°½**: ìºë¦­í„° í´ë¦­ ì‹œ ì˜†ì— ë…ë¦½ëœ ì±„íŒ… ì°½ì´ ì—´ë¦½ë‹ˆë‹¤. ë²„ë¸” ìŠ¤íƒ€ì¼ UIë¡œ ê°€ë…ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
- **IPC ê¸°ë°˜ ìœˆë„ìš° ë“œë˜ê·¸**: íƒ€ì´í‹€ ë°”ê°€ ì—†ëŠ” í”„ë ˆì„ë¦¬ìŠ¤ ìœˆë„ìš°ì—ì„œ ë§¤ë„ëŸ¬ìš´ ë“œë˜ê·¸ ì´ë™ì„ ì§€ì›í•©ë‹ˆë‹¤.
- **ë¡œì»¬ AI ì—°ë™**: Ollama APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤í”„ë¼ì¸ì—ì„œë„ AIì™€ ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ìºë¦­í„° ì„±ê²©**: ì¹œê·¼í•˜ê³  ê·€ì—¬ìš´ ë§íˆ¬ë¡œ ëŒ€í™”í•©ë‹ˆë‹¤.
- **ìƒíƒœ ìœ ì§€**: ì•± ì¬ì‹œì‘ ì‹œì—ë„ ë§ˆì§€ë§‰ ìœˆë„ìš° ìœ„ì¹˜ì™€ ìºë¦­í„° í¬ê¸°ë¥¼ ê¸°ì–µí•©ë‹ˆë‹¤.
- **ì‹œìŠ¤í…œ íŠ¸ë ˆì´**: íŠ¸ë ˆì´ ë©”ë‰´ë¥¼ í†µí•´ ìºë¦­í„° í¬ê¸° ì¡°ì ˆ(100px~500px) ë° ì•± ì¢…ë£Œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ê¸°ìˆ  ìŠ¤íƒ

- **Framework**: Electron 39, React 19
- **Language**: TypeScript
- **Build Tool**: Vite (electron-vite)
- **AI Engine**: Ollama (Local LLM)
- **State Management**: electron-store

## ë¹ ë¥¸ ì‹œì‘

### í•„ìˆ˜ ì‚¬í•­

- [Ollama](https://ollama.com/)ê°€ ì„¤ì¹˜ë˜ì–´ ìˆê³  ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
- `llama3.2` ë˜ëŠ” ì„¤ì •ëœ ëª¨ë¸ì´ ë‹¤ìš´ë¡œë“œë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```bash
# Ollama ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
ollama pull llama3.2
```

### ì„¤ì¹˜ ë° ì‹¤í–‰

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# ê°œë°œ ëª¨ë“œ ì‹¤í–‰
npm run dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ (Windows)
npm run build:win

# í”„ë¡œë•ì…˜ ë¹Œë“œ (macOS)
npm run build:mac
```

## ì‚¬ìš©ë²•

1. `npm run dev`ë¡œ ì•± ì‹¤í–‰
2. ìºë¦­í„°ê°€ í™”ë©´ì— ë‚˜íƒ€ë‚¨ (ê¸°ë³¸: passthrough ëª¨ë“œ)
3. `Cmd/Ctrl + Shift + D`ë¡œ ëª¨ë“œ ì „í™˜:
   - **passthrough**: íˆ¬ëª… ì˜ì—­ í´ë¦­ í†µê³¼ (ê¸°ë³¸)
   - **interactive**: ìºë¦­í„° í´ë¦­ ê°€ëŠ¥ (íŒŒë€ glow)
   - **ghost**: ì™„ì „íˆ í´ë¦­ í†µê³¼ (ë°˜íˆ¬ëª…)
4. interactive ëª¨ë“œì—ì„œ ìºë¦­í„° í´ë¦­ â†’ ì±„íŒ… ì°½ ì—´ë¦¼
5. ë©”ì‹œì§€ ì…ë ¥ í›„ ì „ì†¡ â†’ AI ì‘ë‹µ

## í•µì‹¬ ê°œë…

### 1. ì•ŒíŒŒ ì±„ë„ ë§ˆìš°ìŠ¤ í†µê³¼ (Alpha Channel Passthrough)

ìºë¦­í„°ê°€ í™”ë©´ì„ ê°€ë¦¬ì§€ ì•Šìœ¼ë©´ì„œë„ íŠ¹ì • ë¶€ë¶„ë§Œ í´ë¦­ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.

- **ë™ì‘ ì›ë¦¬**: `usePixelTransparency.ts`ì—ì„œ ìºë¦­í„° ì´ë¯¸ì§€ë¥¼ íˆ¬ëª…í•œ Canvasì— ê·¸ë¦½ë‹ˆë‹¤.
- **ê°ì§€**: ë§ˆìš°ìŠ¤ê°€ ì›€ì§ì¼ ë•Œë§ˆë‹¤ í˜„ì¬ ì¢Œí‘œì˜ í”½ì…€ ì•ŒíŒŒ(Alpha) ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.
- **ì œì–´**:
  - ì•ŒíŒŒ ê°’ = 0 (íˆ¬ëª…): `setIgnoreMouseEvents(true, { forward: true })`ë¥¼ í˜¸ì¶œí•˜ì—¬ í´ë¦­ì´ ë’¤ë¡œ í†µê³¼ë˜ë„ë¡ í•©ë‹ˆë‹¤.
  - ì•ŒíŒŒ ê°’ > 0 (ë¶ˆíˆ¬ëª…): `setIgnoreMouseEvents(false)`ë¥¼ í˜¸ì¶œí•˜ì—¬ ìºë¦­í„°ê°€ í´ë¦­ì„ ë°›ë„ë¡ í•©ë‹ˆë‹¤.

### 2. ìƒí˜¸ì‘ìš© ëª¨ë“œ (Interaction Modes)

ì‚¬ìš©ì í™˜ê²½ì— ë”°ë¼ ìºë¦­í„°ì˜ ê°„ì„­ ì •ë„ë¥¼ ì¡°ì ˆí•©ë‹ˆë‹¤. ì „ì—­ ë‹¨ì¶•í‚¤ `Cmd/Ctrl + Shift + D`ë¡œ ìˆœí™˜ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **passthrough (ê¸°ë³¸)**: ì•ŒíŒŒ ì±„ë„ ê¸°ë°˜ ê°ì§€ê°€ í™œì„±í™”ë©ë‹ˆë‹¤. ìºë¦­í„° ëª¸ì²´ë§Œ í´ë¦­ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- **interactive**: ìºë¦­í„° í´ë¦­ ì‹œ ì±„íŒ… ì°½ì´ ì—´ë¦½ë‹ˆë‹¤. íŒŒë€ìƒ‰ glow íš¨ê³¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.
- **ghost**: ëª¨ë“  ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ë¥¼ ë¬´ì‹œí•©ë‹ˆë‹¤. ìºë¦­í„°ëŠ” ë³´ì´ì§€ë§Œ ë’¤ìª½ ì‘ì—…ì— ì „í˜€ ë°©í•´ë¥¼ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 3. ì´ì¤‘ ì°½ ì•„í‚¤í…ì²˜ (Dual Window Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pet Window     â”‚         â”‚  Chat Window        â”‚
â”‚  (íˆ¬ëª…, ê³ ì •)   â”‚  í´ë¦­â†’  â”‚  (ë¶ˆíˆ¬ëª…, ë²„ë¸” UI)  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Character  â”‚ â”‚         â”‚ â”‚ ëŒ€í™” ë©”ì‹œì§€     â”‚ â”‚
â”‚ â”‚    ğŸ¾       â”‚ â”‚         â”‚ â”‚                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚ â”‚ [ì…ë ¥...] [>]   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Pet Window**: íˆ¬ëª…, ê³ ì • í¬ê¸°, ìºë¦­í„°ë§Œ í‘œì‹œ
- **Chat Window**: ë¶ˆíˆ¬ëª… (#1a1a2e), 380x500, ë²„ë¸” ìŠ¤íƒ€ì¼ ì±„íŒ…

### 4. IPC ê¸°ë°˜ ìœˆë„ìš° ë“œë˜ê·¸ (IPC Window Dragging)

íˆ¬ëª…/í”„ë ˆì„ë¦¬ìŠ¤ ìœˆë„ìš°ì—ì„œëŠ” í‘œì¤€ `-webkit-app-region: drag` ì‚¬ìš© ì‹œ ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ í†µê³¼ ê¸°ëŠ¥ê³¼ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆì–´ ì»¤ìŠ¤í…€ ë¡œì§ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

- **ë™ì‘ ì›ë¦¬**:
  1. Rendererì—ì„œ `mousedown` ë°œìƒ ì‹œ `start-drag` IPC ì „ì†¡
  2. Main Processì—ì„œ í˜„ì¬ ë§ˆìš°ìŠ¤ ì»¤ì„œ ìœ„ì¹˜ì™€ ìœˆë„ìš° ìœ„ì¹˜ ê¸°ë¡
  3. 16ms(60fps) ì£¼ê¸°ë¡œ ì»¤ì„œì˜ ì´ë™ëŸ‰(Delta)ì„ ê³„ì‚°í•˜ì—¬ `win.setBounds`ë¡œ ìœˆë„ìš° ìœ„ì¹˜ ê°±ì‹ 
  4. `mouseup` ë°œìƒ ì‹œ `stop-drag` IPCë¡œ íŠ¸ë˜í‚¹ ì¤‘ë‹¨

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```text
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ ollamaService.ts    # AI ì±„íŒ… (ì„±ê²© + íˆìŠ¤í† ë¦¬)
â”‚   â””â”€â”€ index.ts                # ë©”ì¸ í”„ë¡œì„¸ìŠ¤, ì´ì¤‘ ì°½ ê´€ë¦¬
â”œâ”€â”€ preload/
â”‚   â”œâ”€â”€ index.ts                # IPC ë¸Œë¦¬ì§€
â”‚   â””â”€â”€ index.d.ts              # íƒ€ì… ì •ì˜
â””â”€â”€ renderer/
    â”œâ”€â”€ index.html              # í« ì°½ ì—”íŠ¸ë¦¬
    â”œâ”€â”€ chat.html               # ì±„íŒ… ì°½ ì—”íŠ¸ë¦¬
    â””â”€â”€ src/
        â”œâ”€â”€ assets/
        â”‚   â”œâ”€â”€ characters/     # ìºë¦­í„° ì´ë¯¸ì§€
        â”‚   â”œâ”€â”€ main.css        # í« ìŠ¤íƒ€ì¼
        â”‚   â””â”€â”€ chat.css        # ì±„íŒ… ìŠ¤íƒ€ì¼
        â”œâ”€â”€ hooks/              # React í›… (íˆ¬ëª…ë„, ë“œë˜ê·¸, ëª¨ë“œ)
        â”œâ”€â”€ App.tsx             # í« ì»´í¬ë„ŒíŠ¸
        â”œâ”€â”€ ChatApp.tsx         # ì±„íŒ… ì»´í¬ë„ŒíŠ¸
        â”œâ”€â”€ main.tsx            # í« ì—”íŠ¸ë¦¬
        â””â”€â”€ chat-main.tsx       # ì±„íŒ… ì—”íŠ¸ë¦¬
```

## IPC API Reference

| Channel                    | Method   | Description                           |
| :------------------------- | :------- | :------------------------------------ |
| `set-ignore-mouse-events`  | `send`   | ìœˆë„ìš°ì˜ ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ë¬´ì‹œ ì—¬ë¶€ ì„¤ì • |
| `start-drag` / `stop-drag` | `send`   | ì»¤ìŠ¤í…€ ìœˆë„ìš° ë“œë˜ê·¸ ì‹œì‘/ì¢…ë£Œ        |
| `get-interaction-mode`     | `invoke` | í˜„ì¬ ìƒí˜¸ì‘ìš© ëª¨ë“œ ì¡°íšŒ               |
| `set-interaction-mode`     | `send`   | ìƒí˜¸ì‘ìš© ëª¨ë“œ ë³€ê²½                    |
| `toggle-chat`              | `send`   | ì±„íŒ… ì°½ í† ê¸€                          |
| `close-chat`               | `send`   | ì±„íŒ… ì°½ ë‹«ê¸°                          |
| `chat`                     | `invoke` | Ollama AIì™€ ëŒ€í™” ìˆ˜í–‰                 |
| `get-character-size`       | `invoke` | ì €ì¥ëœ ìºë¦­í„° í¬ê¸° ì¡°íšŒ               |

## ê°œë°œ ê°€ì´ë“œ

- **ì½”ë“œ ìŠ¤íƒ€ì¼**: ì„¸ë¯¸ì½œë¡  ë¯¸ì‚¬ìš©, í™‘ë”°ì˜´í‘œ(`'`) ì‚¬ìš©, 2ìŠ¤í˜ì´ìŠ¤ ë“¤ì—¬ì“°ê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.
- **ê²½ë¡œ ë³„ì¹­**: `@renderer/*`ë¥¼ ì‚¬ìš©í•˜ì—¬ `src/renderer/src/*` ê²½ë¡œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë©€í‹° í˜ì´ì§€**: `electron.vite.config.ts`ì—ì„œ `rollupOptions.input`ìœ¼ë¡œ ì—¬ëŸ¬ HTML ì—”íŠ¸ë¦¬ ì„¤ì •.
- **í« ì°½**: `transparent: true` ìœ ì§€, ë¶ˆíˆ¬ëª… ë°°ê²½ ê¸ˆì§€.
- **ì±„íŒ… ì°½**: `transparent: false`, ë¶ˆíˆ¬ëª… ë°°ê²½ìœ¼ë¡œ ê°€ë…ì„± í™•ë³´.

## ë‹¨ì¶•í‚¤

| ë‹¨ì¶•í‚¤                 | ì„¤ëª…                    |
| ---------------------- | ----------------------- |
| `Cmd/Ctrl + Shift + D` | ìƒí˜¸ì‘ìš© ëª¨ë“œ ìˆœí™˜ ì „í™˜ |
| `ESC` (ì±„íŒ… ì°½)        | ì±„íŒ… ì°½ ë‹«ê¸°            |
